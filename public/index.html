<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Florr - Health Bars Return</title>
<style>
body{margin:0;background:#1a1a1a;overflow:hidden;font-family:'Segoe UI',sans-serif}
canvas{display:block}
#topStats{position:absolute;top:10px;width:100%;text-align:center;color:white;font-size:22px;font-weight:bold;pointer-events:none;text-shadow:2px 2px 4px #000;z-index:10}
#inventory{position:absolute;left:10px;top:50%;transform:translateY(-50%);width:110px;background:rgba(0,0,0,0.5);border:2px solid #444;border-radius:10px;padding:10px;display:grid;grid-template-columns:1fr 1fr;gap:5px;pointer-events:none}
.slot{width:40px;height:40px;background:#222;border:2px solid #555;border-radius:5px;position:relative;overflow:hidden}
.reload-bar{position:absolute;bottom:0;left:0;width:100%;background:#3498db;height:0%}
#minimap{position:absolute;bottom:20px;right:20px;width:150px;height:150px;background:rgba(0,0,0,0.7);border:2px solid #555;border-radius:50%;overflow:hidden}
.overlay{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:#333;padding:40px;border-radius:20px;text-align:center;color:white;z-index:100;border:4px solid #444;width:350px}
button{padding:12px 30px;font-size:20px;background:#2ecc71;color:white;border:none;border-radius:8px;cursor:pointer;font-weight:bold;margin-top:20px}
</style>
</head>
<body>

<div id="topStats">Wave: <span id="waveVal">1</span></div>
<div id="inventory"></div>
<canvas id="minimap"></canvas>
<canvas id="gameCanvas"></canvas>

<div id="startMenu" class="overlay">
<h1>BOSS SLAYER</h1>
<button onclick="initGame()">START</button>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

let player = { x:0,y:0,radius:35 };
let players = {};
let mobs = [];
let waveCount = 1;

function initGame(){
document.getElementById("startMenu").style.display="none";
requestAnimationFrame(gameLoop);
}

socket.on("state", data=>{
players = data.players;
mobs = data.mobs;
waveCount = data.waveCount;
document.getElementById("waveVal").innerText = waveCount;
});

let mouseX=0,mouseY=0;
addEventListener("mousemove",e=>{mouseX=e.clientX;mouseY=e.clientY});

function gameLoop(){
let angle=Math.atan2(mouseY-canvas.height/2,mouseX-canvas.width/2);
player.x+=Math.cos(angle)*9;
player.y+=Math.sin(angle)*9;

socket.emit("update",{x:player.x,y:player.y});

ctx.clearRect(0,0,canvas.width,canvas.height);
ctx.save();
ctx.translate(canvas.width/2-player.x,canvas.height/2-player.y);

// Draw mobs
for(const m of mobs){
ctx.fillStyle=m.color;
ctx.beginPath();
ctx.arc(m.x,m.y,m.radius,0,Math.PI*2);
ctx.fill();
}

// Draw players
for(const id in players){
const p=players[id];
ctx.fillStyle=id===socket.id?"#ffeb3b":"white";
ctx.beginPath();
ctx.arc(p.x,p.y,p.radius,0,Math.PI*2);
ctx.fill();
}

ctx.restore();
requestAnimationFrame(gameLoop);
}
</script>
</body>
</html>
